SvenF | 2024-08-16 12:33:07 UTC | #1

## TL;DR

The IC Target Topology sets targets for the number of Gen1 and Gen2 nodes per subnet and the decentralization coefficients (Nakamato coefficients) per subnet. It  is a model used in the Internet Computer network to optimize the balance between node rewards and decentralization, and is not fixed and is voted in by the community as the target to be achieved within a certain timeframe. The latest IC Target Topology can be found [here](https://forum.dfinity.org/t/ic-topology-node-diversification-part-ii/23553). 

It is proposed to update the IC target topology in order to increase the subnet size of the Fiduciary subnet and II subnet. The main reason for this is to increase the security of the IC since larger subnets require more node machines/node providers colluding with each other in order to take over these subnets. Given that the IC network currently has sufficient spare node machines, no additional node providers or node machines need to be onboarded. The intention is to gradually increase the size of these Fiduciary subnet and II subnet over time, and at a certain (to be determined) time set up specific production and backup subnets for storing the tECDSA signatures.

In addition to increasing the subnet size of the II and Fiduciary subnets, it is proposed to update the country limit for the swiss subnet to 13, which was erroneously set to 2 in the currently approved IC Target Topology table.

## Background

The uzr34 and pzp6e subnets are subnets with 28 active node machines. These subnets have more active node machines than an application subnet (that has 13 active node machines) since the uzr34 and pzp6e support important functionality for the IC:

* The uzr34 subnet runs the Internet Identity, Cycles Ledger, Exchange Rate canister, and XRC dashboard, and stores the backup tECDSA signing keys.
* The pzp6e subnet acts as a Fiduciary subnet and stores the tECDSA signing keys.

With 28 nodes, | 28 / 3 | + 1 or 10 nodes need to be malicious in order to take control of these subnets. By adding more node machines to these subnets, more node machines/node providers need to collude to take over the subnet. Hence, adding more node machines to these subnets will add to the security of these subnets.

It is proposed to improve the security of these subnets by adding more node machines. This will mean an update of the IC target topology that was previously [approved](https://dashboard.internetcomputer.org/proposal/125549) on 12th November 23. As there are currently more node machines in the IC network than required to meet the decentralization targets set in the target topology, no new node machines will need to be onboarded, and spare node machines can be used to increase the size of the uzr34 and pzp6e subnets.

## Roll-out plan

With the currently available nodes, the uzr34 and pzp64 subnets can be increased to 34 node machines and still meet decentralization targets.

For the long term, the following roll-out plan is intended:

1. Further increase the subnet size of uzr34 and pzp64 with 3 nodes every time when spare nodes are available. The reason for adding nodes in multiples of 3 is that each three nodes will result in one more additional node machine having to act maliciously to take over the subnet.
2. As a final step in the roll-out plan, separate ECDSA signing and ECDSA backup subnets will be created, provided the load on the subnets requires to have separate subnets for ECDSA, and sufficient spare node machines are available to meet the decentralization coefficients.

Hence, although the target subnet size of uzr34 and pzp64 are increased, this will be planned for gradually. This proposal is not intended to propose that new node providers or new node machines will be onboarded.
**![|551x350](upload://zasBGVxoWGFEQY7eIkNbtAUTarE.png)**
*Figure 1 - node allocation to subnets after changing subnet size of uzr34 and pzp64 to 31 node machines*

## Updated Target Topology

The below table shows the proposed changes in the target topology. The columns in grey show the changes in target topology as compared to the previously approved target topology.

![image|674x500](upload://uFqXSI8og0inCIK7jVpKe0ORDI3.png)

**Correction on previously published target topology, as Swiss subnet will only have nodes located in Switzerland*

In addition to increasing the subnet size of the II and Fiduciary subnets, it is proposed to update the country limit for the Swiss Subnet to 13, which was erroneously set to 2 in the currently approved IC Target Topology table. Note that there currently is no Swiss subnet yet implemented.

## Motion Proposal

As always, feedback from the community is very much appreciated on this proposal. Depending on the feedback, the intention is to formally submit a motion proposal for voting in the course of next week.

-------------------------

wpb | 2024-08-16 14:05:16 UTC | #2

This seems like a very important change @SvenF.  Thanks for sharing.

My question is related to how much additional work you think it will take for people to review these additional proposals.  I know the current IC Target Topology was implemented within the last year and it was a major change.  There was a significant increase in the flux of Participant Management, Node Admin, and Subnet Management proposals during the implementation of that change.  Presumably that means it took a lot more time for DFINITY to review and approve those proposals.  

I'm asking because of the current [Grants for Known Neurons](https://forum.dfinity.org/t/grants-for-voting-neurons/32721?u=wpb) program that DFINITY is offering to encourage more active participation in technical reviews and independent voting by community members.  The topics covered by this program include Subnet Management, which is likely going to be most heavily impacted by this proposed IC Target Topology change.  Based on the current rate of Subnet Management proposals we are seeing, I believe the grant that is offered for this topic is already too low compared to the work required.  Hence, if this new IC Target Topology proposal has a significant increase in proposals, then it could put more work on those reviewers.  After the romance wears off from being chosen by the NNS to perform these reviews and the successful candidates get into the routine state of the job, I'm worried that they may quickly find themselves regretting the commitment.  Do you think this could be an issue?  Or do you think there will be a negligible impact on workload to review the proposals that result from this change?  I'm wondering if the grant that is offered for this topic should be increased.  I'd love to know what you think @SvenF,  @lara, and @cryptoschindler.

-------------------------

SvenF | 2024-08-16 14:52:33 UTC | #3

Hi @wpb, having a the subnet size for two subnets increased will not significantly change the number of proposals for subnet management. After the motion proposal being approved, there will be a proposal to add additional nodes for each of these two subnets. And just like for any subnet, if there is a node machine that needs to be swapped (for being unhealthy or optimizing decentralization) there will be another proposal, but as you have probably seen these do not happen very often as node machines are pretty reliable. You can see this from the number of subnet proposals every week.

-------------------------

Lorimer | 2024-08-16 22:40:15 UTC | #4

Thanks for this announcement @SvenF, and for the clear explanation.

[quote="SvenF, post:1, topic:34210"]
As a final step in the roll-out plan, separate ECDSA signing and ECDSA backup subnets will be created
[/quote]

This sounds good, avoiding the need for downtime of important services when there's a need to reshare keys between subnets (e.g. [Generation of Schnorr production keys and II subnet downtime - Developers - Internet Computer Developer Forum (dfinity.org)](https://forum.dfinity.org/t/generation-of-schnorr-production-keys-and-ii-subnet-downtime/33829)).

Are there any plans for what other responsibilities these new subnets may have (presumably the backup subnet won't house any other critical services)?

[quote="SvenF, post:1, topic:34210"]
With the currently available nodes, the uzr34 and pzp64 subnets can be increased to 34 node machines and **still meet decentralization targets**.
[/quote]

What sort of capacity utilisation does this account for? i.e. It's possible to meet decentralisation targets under ideal circumstances, but presumably there will continue to be a need for a level of redundancy (which allow decentralisation targets to be met even when a certain percentage of allocated nodes go down or become degraded). Or is the idea that nodes can just be reclaimed from the larger subnets if needed (for use by a struggling subnet), rather than sitting idle in the meantime as they often are now?

-------------------------

dfisher | 2024-08-16 23:15:46 UTC | #5

Looks great, and makes total sense. 

What do you think the max number of nodes for these high security subnets could be? Potentially 100 or more in the future?

-------------------------

SvenF | 2024-08-19 08:06:41 UTC | #6

[quote]
Are there any plans for what other responsibilities these new subnets may have (presumably the backup subnet won't house any other critical services)?
[/quote]

Tahnks @lorimer, there are no other plans yet but as these subnets are intended to be more secure by having more nodes, I could imagine there would be plans in the future to store additional keys or run other critical dapps from these subnets.

[quote]
What sort of capacity utilisation does this account for? 
[/quote]

What I intended to say was that there still are sufficient spare nodes - so nodes that are not in a subnet yet - that can be added to increase the II and Fiduciary subnet. The IC currently has more spare nodes than was calculated in the Target Topology, i.e. more spare nodes than the 120 spare nodes that are shown in the table above. But the idea is not to move nodes from for example an active application subnet to a struggling subnet; the spare nodes are intended to be swapped into any subnet if it has one or more dead node machines.

-------------------------

SvenF | 2024-08-19 08:09:06 UTC | #7

Hi @dfisher, the target for the future is 41 node machines, but there are some limits to the registry size that have to be taken into account.

-------------------------

Lorimer | 2024-08-19 16:50:34 UTC | #8

Thanks for this info @SvenF 

[quote="SvenF, post:6, topic:34210"]
I could imagine there would be plans in the future to store additional keys or run other critical dapps from these subnets
[/quote]

Would there also be plans to implement a key resharing mechanism that doesn't require downtime (halting the subnet)? It seems unfortunate that critical services need to be halted for a number of minutes while keys are being reshared if they reside on the key backup subnet. Why not reserve the backup subnet for non-critical services (other than holding backup keys)?

-------------------------

lastmjs | 2024-08-20 12:12:57 UTC | #9

What does the SEV column indicate? That SEV is planned for a subnet?

If so, I'm concerned. Shouldn't all subnets eventually be SEV? I'm especially concerned at the moment for the threshold key subnets.

-------------------------

SvenF | 2024-08-20 14:55:18 UTC | #10

Hi @lastmjs, the SEV column indicates whether the nodes in that particular subnet need to be SEV enabled. Currently, the Gen2 node machines support SEV but the Gen1 node machines do not support this. Hence the most criticial subnets (e.g. treshhold key subnets) are marked as SEV; these subnets should only contain Gen2 node machines. The other subnets not marked as SEV may contain either Gen1 node machines or Gen2 node machines. For the long term, it is the intention that all nodes will be SEV nodes, but this will require gradual replacement of the Gen1 node machines by a future new node machines specification.

-------------------------

lastmjs | 2024-08-20 15:11:02 UTC | #11

Thanks for the explanation. I was concerned because the fiduciary subnet is marked as not having SEV, which it says is the subnet used for threshold signing today.

-------------------------

Lorimer | 2024-08-20 17:20:00 UTC | #12

[quote="SvenF, post:1, topic:34210"]
Given that the **IC network currently has sufficient spare node machines**, no additional node providers or node machines need to be onboarded
[/quote]

[quote="sat, post:14, topic:34056"]
An empirical observation: **we very rarely have enough nodes** decentralized nodes to have a Nakamoto of 3 for country
[/quote]

A Nakamoto coefficient of 3 is required for a 13 node subnet in order to meet the requirements of the target topology (and higher for larger subnets).

Please let me know what I'm missing :slight_smile: I hope you can understand my confusion.

-------------------------

