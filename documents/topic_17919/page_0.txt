skilesare | 2024-01-23 07:43:59 UTC | #1

# ICRC-2 and ICRC-3 - Motoko - #44

## Current Status: Discussion

* Discussion (01/09/2023)
* Ratification: (01/09/2023) 
* Open for application: (01/09/2023)
* Assigned 
* In Review 
* Closed 

[Official Link](https://icdevs.org/bounties/2023/01/09/44-ICRC-2-and-ICRC-3-Motoko.html)

## Bounty Details

* Bounty Amount: $6,000 USD of ICP at award date.
* ICDevs.org Bounty Acceleration: For each 1 ICP sent to 25be490ab9521ab06c8fb5456a1f376e71204aa565513391322b59b0177aea38, ICDevs.org will add  .25 ICP to this issue and .75 ICP to fund other ICDevs.org initiatives.
* Project Type: Individual
* Opened: 01/09/2023
* Time Commitment: Days
* Project Type: Library
* Experience Type: Beginner - Motoko;

## Description

ICDevs.org has funded the ICRC-1 motoko library at https://github.com/NatLabs/icrc1. It is now time to add the ICRC-2(approval workflow) and ICRC-3(ledger and block query functionality).  These are still subject to approval by the working group, but work can begin now.

The ICRC-2 spec can be found at https://github.com/dfinity/ICRC-1/blob/main/standards/ICRC-2/README.md

The beginnings of ICRC-3 are at https://github.com/dfinity/ICRC-1/tree/roman-icrc3/standards/ICRC-3 but are still under debate by the working group.

To complete this bounty you will need to participate with the working group to help finalize ICRC-2 and 3, and then build the modules as optional add-ins is to https://github.com/NatLabs/icrc1.  You can gate the standards with a switch that can be configured via a setup configuration and/or management function.

This bounty gives the opportunity to

* learn about Motoko
* learn about ICRC-2 and ICRC-3
* learn about ICRC-1

## To apply for this bounty you should:

* Include links to previous work writing tutorials and any other open-source contributions(ie. your github).
* Include a brief overview of how you will complete the task. This can include things like which dependencies you will use, how you will make it self-contained, the sacrifices you would have to make to achieve that, or how you will make it simple. Anything that can convince us you are taking a thoughtful and expert approach to this design.
* Give an estimated timeline on completing the task.
* Post your application text to the Bounty Thread

## Selection Process

The ICDevs.org developer's advisors will propose a vote to award the bounty and the Developer Advisors will vote.

## Bounty Completion

Please keep your ongoing code in a public repository(fork or branch is ok). Please provide regular (at least weekly) updates.  Code commits count as updates if you link to your branch/fork from the bounty thread.  We just need to be able to see that you are making progress.

The balance of the bounty will be paid out at completion.

Once you have finished, please alert the dev forum thread that you have completed work and where we can find that work.  We will review and award the bounty reward if the terms have been met.  If there is any coordination work(like a pull request) or additional documentation needed we will inform you of what is needed before we can award the reward.

## Bounty Abandonment and Re-awarding

If you cease work on the bounty for a prolonged(at the Developer Advisory Board's discretion) or if the quality of work degrades to the point that we think someone else should be working on the bounty we may re-award it.  We will be transparent about this and try to work with you to push through and complete the project, but sometimes, it may be necessary to move on or to augment your contribution with another resource which would result in a split bounty.

## Funding

The bounty was generously funded by the DFINITY Foundation. If you would like to turbocharge this bounty you can seed additional donations of ICP to 25be490ab9521ab06c8fb5456a1f376e71204aa565513391322b59b0177aea38.  ICDevs will match the bounty $40:1 ICP for the first 75 ICP out of the DFINITY grant and then 0.25:1.  All donations will be tax deductible for US Citizens and Corporations.  If you send a donation and need a donation receipt, please email the hash of your donation transaction, physical address, and name to donations@icdevs.org.  More information about how you can contribute can be found at our [donations page](https://icdevs.org/donations.html).


## FYI: General Bounty Process

### Discussion

The draft bounty is posted to the DFINITY developer's forum for discussion

### Ratification: (01/09/2023)

The developer advisor's board will propose a bounty be ratified and a vote will take place to ratify the bounty.  Until a bounty is ratified by the Dev it hasn't been officially adopted. Please take this into consideration if you are considering starting early.

### Open for application

Developers can submit applications to the Dev Forum post.  The council will consider these as they come in and propose a vote to award the bounty to one of the applicants.  If you would like to apply anonymously you can send an email to austin at icdevs dot org or sending a PM on the dev forum.

### Assigned

A developer is currently working on this bounty, you are free to contribute, but any splitting of the award will need to be discussed with the currently assigned developer.

### In Review

The Dev Council is reviewing the submission

### Awarded

The award has been given and the bounty is closed.=

[Other ICDevs.org Bounties](https://icdevs.org/bounties.html)

-------------------------

skilesare | 2023-01-11 14:33:51 UTC | #2

Due to the amazing work on the bounty 26, @tomijaga has right of first refusal on this bounty.

-------------------------

rckprtr | 2023-01-11 17:20:53 UTC | #3

Wow, ICRC-2 I'm excited about, but ICRC-3 also looks great.

-------------------------

tomijaga | 2023-01-20 16:21:17 UTC | #5

Hey @skilesare, I will be declining this bounty to apply for the [Zip Encoder/Decoder Library].

I can help the person who picks this bounty to get up to speed with the [ICRC-1 implementation](https://github.com/NatLabs/icrc1) and also help review their add-ins for ICRC-2 and 3.

-------------------------

JingJingZhang9 | 2023-01-26 09:58:08 UTC | #6

The ICRC-3 sounds great and well worth doing, I'm very interest in it.
I work with motoko for a long time, also, I have participated in projects of other ICDevs funds.

-------------------------

JingJingZhang9 | 2023-02-16 05:30:17 UTC | #8

Hey, I am very interested in this proposal. I have experience using Motoko programming, which I believe will be a valuable skill in this proposal. Additionally, I have knowledge of ICRC2. Also, As a member of RankRadar, I have received a grant from Dfinity in the past.@ [skilesare](https://forum.dfinity.org/u/skilesare)

-------------------------

skilesare | 2023-02-18 13:11:37 UTC | #9

Awesome!  I'll submit it to the board, but there should be no issue with you getting started.  Good Luck!

https://77i6o-oqaaa-aaaag-qbm6q-cai.ic0.app/axon/1/proposal/22

@icme, @aiv, @quint, @mparikh, please vote :slight_smile:

-------------------------

JingJingZhang9 | 2023-03-06 06:28:53 UTC | #10

hey, I am reading the source code of ICRC1 and standard of ICRC2, and started doing it.

-------------------------

gladguy | 2023-03-12 17:40:40 UTC | #11

Hey, 

There reading the source. Hope still application are accepted?

-------------------------

JingJingZhang9 | 2023-03-13 06:02:51 UTC | #12

hey, update me on my progress, I plan to start updating the code this week, I got all the preparations done last week,
The expected completion time is about two months, and the general plan is as follows:
1. First confirm the latest updated features of motoko (this work was completed last week)
2. Develop related functions of icrc2 (currently in progress)
3. Debug code
4. Give reference examples and corresponding commands
5. Supplementary documentation
6. If necessary, prepare some test cases

-------------------------

skilesare | 2023-03-13 12:21:04 UTC | #13

Just want to make sure you are forking off of https://github.com/NatLabs/icrc1 as that will have the base icrc1 functionality you'll need.

-------------------------

JingJingZhang9 | 2023-03-14 07:38:43 UTC | #14

yeah,  this is what I am using now, thx.

-------------------------

JingJingZhang9 | 2023-03-29 12:35:29 UTC | #15

hey, I update the code of ICRC2, please check
https://github.com/JingJingZhang9/I2-code

-------------------------

JingJingZhang9 | 2023-03-31 06:14:13 UTC | #16

@skilesare please check the code of ICRC2, also about the standard of ICRC3, dose it set？

-------------------------

JingJingZhang9 | 2023-04-20 12:57:30 UTC | #17

Hi, we submitted our work some time ago, were you able to verify it? Since we completed the work for ICRC-2, and ICRC-3 won't be standardized any time soon, is it possible to split the work into 2 and give us half of the rewards? Someone else (or us) could take up the second half which is ICRC-3 in the future.@skilesare

-------------------------

skilesare | 2023-04-20 13:30:42 UTC | #18

I'm so sorry...I totally missed this...I'll get it on the list for review/payment asap.  We can split it. I had hoped the working group would have made more progress, but it has been slow.

-------------------------

skilesare | 2023-04-21 13:36:14 UTC | #19

Could you create a pull request into the NatLabs/ICRC1 repo so we can see direct changes and updates to the library?

-------------------------

JingJingZhang9 | 2023-04-21 13:52:47 UTC | #20

hey, I also agree that splitting ICRC-2 and ICRC-3 is a good idea, so we can more effectively handle each part. Once the standards for ICRC-3 are established, I would be more than happy to continue contributing to the project.
As for the code,  I will reorganize the code and create a pull request to the NatLabs/ICRC1 repository as soon as possible so that you can directly review the changes and updates in the library. 
I will let you know when I done it.

-------------------------

JingJingZhang9 | 2023-04-21 16:16:58 UTC | #21

I think I've successfully created the pull request, please check. 
If there are any issues, feel free to contact me. If there's anything that needs to be modified, please let me know, and I'll make the changes promptly.

-------------------------

skilesare | 2023-05-11 18:39:59 UTC | #22

Hi @JingJingZhang9, I wanted check and see if you saw the adjustments that were made to ICRC 2 and if they had any effect on your code implementation. We are voting to approve the spec today!

https://github.com/dfinity/ICRC-1/tree/main/standards/ICRC-2
https://github.com/dfinity/ICRC-1/pull/109

-------------------------

JingJingZhang9 | 2023-05-23 15:56:55 UTC | #23

[quote="skilesare, post:22, topic:17919"]
Hi @JingJingZhang9, I wanted check and see if you saw the adjustments that were made to ICRC 2 and if they had any effect on your code implementation. We are voting to approve the spec today!
[/quote]

Thank you for the reminder. I appreciate your diligence. I will allocate some time to carefully review the new standards and make the necessary modifications to ensure compliance. Your input is valuable, and I will take it into consideration during the revision process.

-------------------------

receronp | 2023-05-26 17:00:03 UTC | #24

@skilesare I saw that this bounty had been stale for some time at the beginning of the week, so I worked on a different implementation that keeps ICRC-1 and ICRC-2 as separate standards, with ICRC-2 making use of the ICRC-1 codebase for code reuse and compatibility.
These changes are compliant with the latest ICRC-2 adjustments for ERC-20 semantics for approvals.

You can see these changes in the PR I created here:
https://github.com/NatLabs/icrc1/pull/12
Furthermore, I'm planning to continue work on the ICRC-3 Standard based on the shared Draft.

-------------------------

receronp | 2023-05-26 17:53:23 UTC | #25

@skilesare I noticed that the Github Workflow to test Push/PR's is currently failing, so I also submitted a PR to the standards repository that should solve this issue.
https://github.com/dfinity/ICRC-1/pull/116
Once approved, the submodule reference will need to be updated to point to the latest version of the DFINITY ICRC-1 repository.

-------------------------

receronp | 2023-05-29 19:58:20 UTC | #26

@skilesare I have published a PR with the additional method required for ICRC-3. 
I've kept an additional field for the Transfer type that stores the index. This is due to the way the Archive class is set up, and how it checks against duplicate transactions from the work already done by @tomijaga for ICRC-1.
You can find the PR here:
https://github.com/NatLabs/icrc1/pull/18

Should there be any questions, please let me know.

-------------------------

receronp | 2023-05-31 00:38:23 UTC | #27

@skilesare can a vote be done to assign me to this bounty?

-------------------------

skilesare | 2023-05-31 11:43:24 UTC | #28

This bounty is currently assigned to @JingJingZhang9 and we are reviewing the submission. If it is declined we can look at reassigned, but it was completed once according to the proposed spec and then updated to the final spec. @tomijaga is currently reviewing.

-------------------------

receronp | 2023-06-02 15:58:04 UTC | #29

@skilesare any updates on the review process? No changes have been applied to the PR by @JingJingZhang9 since end of April, even after request by @tomijaga to merge changes from main ICRC1 repository.

-------------------------

receronp | 2023-06-06 15:37:46 UTC | #30

@skilesare updates on this?

-------------------------

JingJingZhang9 | 2023-06-09 15:13:43 UTC | #31

I recently attended the working group meeting and had the opportunity to gather valuable insights about the icrc2 standard.
I understand your concern, but the standard has not yet been finalized. Similarly, the official version of Rust is still under discussion and is not yet final. Thus, at this stage, I have not made any major modifications to the code, but rather am gradually optimizing and improving it. When the standard is determined, I am always ready to respond to any further modifications that may arise.

-------------------------

skilesare | 2023-06-09 17:29:39 UTC | #32

ICRC2 has passed NNS Vote.  It should be finalized now.

-------------------------

receronp | 2023-06-12 16:17:28 UTC | #33

@skilesare as an update, received a message from @tomijaga that my proposed PR with the complete ICRC2 standard is currently under review. 
https://github.com/NatLabs/icrc1/pull/12

-------------------------

JingJingZhang9 | 2023-06-15 13:44:51 UTC | #34

 I'm currently making some modifications and I'll submit the new version in the next 2 to 3 days.

-------------------------

JingJingZhang9 | 2023-06-19 15:51:13 UTC | #35

I have now resubmitted the project code for icrc2，
and here is the GitHub link for the project：https://github.com/JingJingZhang9/I2-code
Please do not hesitate to contact me should there be any necessary modifications. I am ready to make immediate changes to ensure the code meets the requirements of the project. Your feedback is greatly appreciated, and I am committed to contributing to this valuable open source initiative.

-------------------------

skilesare | 2023-07-24 19:32:47 UTC | #36

Since @receronp is closest to finishing this I'm going to split this into ICRC 2 and 3 and assign the 2 to receronp.  I think the Pull request is pretty close.

-------------------------

gatsby_esp | 2023-07-26 20:33:22 UTC | #37

Are these standards going to make easier the integration of third party apps for TAX REPORTS such as KOINLY?

-------------------------

gatsby_esp | 2023-08-03 21:31:57 UTC | #38

How can it takes 7 months to develop a new icrc standard If it is just adding a new function? What’s the ETA to update Sns icrc1 tokens with icrc2 and icrc3????
Both are extremely important for trading Sns tokens and thus, Defi on ICP!! I can’t understand why the community won’t involve with this issue.

-------------------------

skilesare | 2023-08-04 15:16:10 UTC | #39

I believe we have ICRC2 dialed and approved and already and implementations are advancing.  I think you'll see it in SNS soonish and hopefully in ICP after that.

ICRC-3 is wrapping up as well.

It takes time because these standards are a public good and no one wants to fund public goods.  Almost everyone is convinced they are going to build the next great dapp and that is where their focus is(and the ecosystem suffers as every project builds the same would-be-public functionality over and over and over). Everyone that has been in these working groups has their own project and is typically busy and swamped.  

It is a function of lack of attention on the IC and a lack of resources to fund IC initiatives.  In more popular ecosystems some of this emerges organically, but we haven't had enough critical mass to have these things emerge organically.  DFINITY has done a really great job of underwriting this activity to date, but for real acceleration to occur it needs to be accelerated by community participation.  

I've taken some stabs at it with ICDevs.org and I think we've done some good, but as far as a going-concern-entity that can contribute to the broader ecosystem, the organization is just massively resource constrained.  Nothing would make me happier than to hire a full-time person to focus on standards, but we currently only have about $27k in our treasury(locked 8-year neuron) and that produces about $4800 a YEAR in revenue that we could try to do something with(with no reinvestment).  If ICP were at $80 like it was when a significant portion of our treasury was donated it would be doable, but the because of the price action, it just isn't.  So in the meantime, we're doing the best we can.

As far as the specific standards go, you are trying to enshrine something that, if done poorly, could cause massive heartache and loss of value in the future.  You have to attempt to predict how to make something that is useful for the community, but that can't be leveraged by an attacker to degrade the system.  That is not easy.    We are probably due for a "summit" of some kind where we can get everyone together for a week or two and just power through some things(this takes significant resources to pull off), but in the meantime, most WG are meeting for an hour every two weeks, so progress is slow.

-------------------------

cyberowl | 2023-08-10 07:43:33 UTC | #40

I will take a look. I need to get onboarded into ICRC at some point. I can look into the Motoko side of things. 

I have been focusing on other areas so I have not looked into it, but you are right we need to allocate our time for these public goods. 

Thanks for doing all that great work with such a limited budget.

-------------------------

cyberowl | 2023-08-10 08:37:48 UTC | #41

[quote="skilesare, post:39, topic:17919"]
“summit” of some kind where we can get everyone together for a week or two and just power through some things
[/quote]

That would be cool. Getting the minds in a room/hackathon without distraction is prob the best way to go.

Like you said it hasn't been easy to be in crypto. Hopefully it does get better.

Do you know what is the latest repo with work from ICRC2 ?

-------------------------

Mercury | 2023-09-29 08:02:34 UTC | #42

Any updates on ICRC-2 going live? So many use cases depend on it...

-------------------------

gatsby_esp | 2023-09-29 08:34:40 UTC | #43

How can it take months to develop an extension of a standard?

-------------------------

gatsby_esp | 2023-10-03 22:14:03 UTC | #44

Hiii anybody there??

-------------------------

Mercury | 2023-10-05 04:34:22 UTC | #45

It's sad to see that DFINITY's arguably the strongest differentiator, ckBTC, is left incomplete for B2B use cases as it lacks ICRC-2. It's all about prioritization, and surely DFINITY has the headcount to handle a relatively low resource work like ICRC-2, yet it chooses to create a "bounty" for it. Bounty?! Seriously?!

-------------------------

gatsby_esp | 2023-10-05 04:52:32 UTC | #46

Agreed. Makes no sense

-------------------------

sea-snake | 2023-10-05 06:40:03 UTC | #48

Uhm, this bounty has been created by an independent developer organization called icdevs not dfinity. You can find more information about icdevs here: https://icdevs.org/who_we_are.html

It's great to see organizations like icdevs organize bounties like this to move the community forward, let's not spam these threads with unrelated things.

See my response in the other thread for more details regarding the Rust icrc ledger canister.

-------------------------

gatsby_esp | 2023-10-05 06:46:48 UTC | #49

Not blaming ICDevs. They are awesome.
We blame dfinity for not developing such an important matter as icrc2 &3.
With out it:
- Defi won’t kick off
- Cex integrations won’t happen
- Coin info listings won’t happen
- automatic Tax report won’t happen (WHO IS GOING TO INVEST ON ICP without tools like cointrack for tax report.)

-------------------------

sea-snake | 2023-10-05 06:48:18 UTC | #50

Please go to the other thread and read my comment. Also move the discussion over there to keep this bounty thread on topic.
https://forum.dfinity.org/t/ckbtc-is-incomplete-without-icrc-2-dfinity-please-dont-let-this-drag-on-forever-with-a-bounty-approach/23513

-------------------------

Mercury | 2023-10-05 08:23:27 UTC | #51

Well said, I'll remove my post from here, "General" is the place for such discussions. I didn't mean to offend anyone from the ICDevs.org , apologies for that. And thanks for responding.

-------------------------

skilesare | 2023-10-05 13:26:17 UTC | #52

This bounty has nothing to do with DFINITY's implementation of ICRC2 into ckBTC or the base SNS token(which I think has been completed and just needs to be activated).  This was for motoko code for devs that wanted to issue their own motoko based ICRC2 token outside of the SNS.

-------------------------

agentDPS | 2024-01-22 21:03:53 UTC | #53

is this bounty still open or assigned to someone ?

-------------------------

skilesare | 2024-01-22 21:17:55 UTC | #54

It is closed, but I can't edit the title any more. :grimacing:

-------------------------

agentDPS | 2024-01-22 21:25:55 UTC | #55

I am assuming you can't also edit the other ic bounty and they too aren't accurately updated?

-------------------------

Severin | 2024-01-23 07:45:06 UTC | #56

As a mod I can still edit the title so I marked it as closed. @skilesare feel free to ping me if you need any other edits :hammer:

-------------------------

